#include "userosc.h"

typedef struct State {
  float phase;
  uint8_t flags;
  uint8_t wavetable_index;
  uint32_t step_count;
  uint8_t eg_enabled;
  float eg_scale;
} State;

static State state;

extern float wavetable0[];
extern float wavetable1[];
extern uint16_t wavetable0_len;
extern uint16_t wavetable1_len;

uint16_t wavetable_len[2];
float* wavetables[2];

enum {
  flags_clear = 0,
  flag_noteon = 1 << 0,
  flag_noteoff = 1 << 1,
};

void OSC_INIT(uint32_t platform, uint32_t api) {
  state.phase = 0.f;
  state.flags = flags_clear;
  state.wavetable_index = 0;
  state.step_count = 0;
  state.eg_enabled = 0;
  state.eg_scale = 1.0;

  wavetables[0] = wavetable0;
  wavetable_len[0] = wavetable0_len;
  wavetables[1] = wavetable1;
  wavetable_len[1] = wavetable1_len;
}

float get_signal_from_wavetable(const float phase, const float w_delta) {
  const uint16_t index = (uint16_t) ((float) wavetable_len[state.wavetable_index] * (phase - (uint16_t) phase));
  return wavetables[state.wavetable_index][index];
}

void OSC_CYCLE(const user_osc_param_t* params,
               int32_t* yn,
               const uint32_t frames) {  
  // Handle the reset flag on NOTEON.
  if (state.flags & flag_noteon) {
    state.flags = flags_clear;
    state.phase = 0.f;
    state.step_count = 0;
  }

  // Restore the last state.
  float phase = state.phase;
  uint32_t steps = state.step_count;
  uint8_t eg_enabled = state.eg_enabled;
  float eg_scale = state.eg_scale;

  // Calculate the current phase.
  const float w_delta = osc_w0f_for_note((params->pitch)>>8, params->pitch & 0xFF);

  // Prepare the result buffer.
  q31_t* __restrict y = (q31_t*) yn;
  const q31_t* y_e = y + frames;

  for (; y != y_e; ) {

    // Main signal
    const float drive = (get_signal_from_wavetable(((float) steps / k_samplerate * eg_scale), w_delta) + 1.0) / 2.0;
    const float sig  = osc_softclipf(0.05f, (eg_enabled == 1 ? drive : 1.0) * get_signal_from_wavetable(phase, w_delta));
    *(y++) = f32_to_q31(sig);

    // Next step.
    phase += w_delta;
    phase -= (uint32_t) phase; // to keep phase within 0.0-1.0.
    if (steps < k_samplerate / eg_scale) ++steps;
  }

  // Store the state.
  state.phase = phase;
  state.step_count = steps;
}

void OSC_NOTEON(const user_osc_param_t * const params) {
  state.flags |= flag_noteon;
}

void OSC_NOTEOFF(const user_osc_param_t * const params) {
  state.flags |= flag_noteoff;
}

void OSC_PARAM(uint16_t index, uint16_t value) {
  switch (index) {
  case k_user_osc_param_id1:
    state.wavetable_index = value;
    break;
  case k_user_osc_param_id2:
    state.eg_enabled = value;
    break;
  case k_user_osc_param_id3:
    state.eg_scale = (float) value;
    break;
  case k_user_osc_param_id4:
  case k_user_osc_param_id5:
  case k_user_osc_param_id6:
  case k_user_osc_param_shape:
  case k_user_osc_param_shiftshape:
  default:
    break;
  }
}

// Mt. Fuji.
float wavetable0[] = {
  -0.9950347, -0.9954216, -0.9958085, -0.9960664, -0.9963244, -0.9965823, -0.9968402, -0.9970337, -0.9972916, -0.9974851,
  -0.9977430, -0.9980010, -0.9983234, -0.9985813, -0.9987103, -0.9977430, -0.9965178, -0.9952281, -0.9940029, -0.9932936,
  -0.9932936, -0.9932936, -0.9932936, -0.9932936, -0.9934225, -0.9934870, -0.9935515, -0.9938094, -0.9939384, -0.9941964,
  -0.9945188, -0.9947767, -0.9949702, -0.9951636, -0.9949057, -0.9947122, -0.9945188, -0.9943253, -0.9941319, -0.9939384,
  -0.9941964, -0.9945188, -0.9947122, -0.9950347, -0.9951636, -0.9950347, -0.9948412, -0.9947122, -0.9945188, -0.9947122,
  -0.9948412, -0.9950347, -0.9951636, -0.9952926, -0.9952281, -0.9952281, -0.9951636, -0.9950991, -0.9950991, -0.9952926,
  -0.9954861, -0.9956795, -0.9958730, -0.9960664, -0.9962599, -0.9964533, -0.9966468, -0.9967758, -0.9969692, -0.9972271,
  -0.9974206, -0.9976141, -0.9978720, -0.9978720, -0.9976141, -0.9974206, -0.9971627, -0.9969047, -0.9966468, -0.9964533,
  -0.9961954, -0.9960019, -0.9957440, -0.9954861, -0.9952926, -0.9951636, -0.9950347, -0.9949057, -0.9947767, -0.9945833,
  -0.9945833, -0.9949702, -0.9954216, -0.9959374, -0.9965178, -0.9968402, -0.9969047, -0.9968402, -0.9964533, -0.9961954,
  -0.9960019, -0.9958730, -0.9956150, -0.9952926, -0.9949702, -0.9946478, -0.9945188, -0.9942608, -0.9939384, -0.9936160,
  -0.9930356, -0.9923908, -0.9916814, -0.9910366, -0.9902628, -0.9894890, -0.9887151, -0.9879413, -0.9871675, -0.9867161,
  -0.9862002, -0.9857488, -0.9853619, -0.9849105, -0.9844591, -0.9840722, -0.9836208, -0.9831694, -0.9827180, -0.9823956,
  -0.9822022, -0.9818797, -0.9815573, -0.9812994, -0.9809769, -0.9806545, -0.9803966, -0.9803321, -0.9804611, -0.9806545,
  -0.9807190, -0.9807190, -0.9806545, -0.9806545, -0.9803966, -0.9800097, -0.9796228, -0.9791714, -0.9787845, -0.9783331,
  -0.9778172, -0.9773658, -0.9768499, -0.9763340, -0.9758826, -0.9754957, -0.9748509, -0.9743995, -0.9737546, -0.9733032,
  -0.9729163, -0.9724649, -0.9720780, -0.9716911, -0.9711108, -0.9704014, -0.9702080, -0.9699500, -0.9695631, -0.9692407,
  -0.9689183, -0.9685958, -0.9682734, -0.9680155, -0.9676931, -0.9671772, -0.9663389, -0.9651781, -0.9659520, -0.9669837,
  -0.9677575, -0.9689828, -0.9702724, -0.9715621, -0.9729163, -0.9742060, -0.9749798, -0.9757537, -0.9765920, -0.9774948,
  -0.9783331, -0.9791714, -0.9799452, -0.9807190, -0.9812994, -0.9819442, -0.9826536, -0.9833629, -0.9840722, -0.9847816,
  -0.9849750, -0.9848460, -0.9847816, -0.9846526, -0.9845881, -0.9845881, -0.9854264, -0.9864582, -0.9874254, -0.9882637,
  -0.9885217, -0.9891020, -0.9900048, -0.9909076, -0.9917459, -0.9920684, -0.9916814, -0.9916170, -0.9914880, -0.9912300,
  -0.9911656, -0.9912300, -0.9912945, -0.9913590, -0.9908431, -0.9898114, -0.9887151, -0.9877479, -0.9878123, -0.9878768,
  -0.9879413, -0.9879413, -0.9879413, -0.9881993, -0.9885217, -0.9887796, -0.9890376, -0.9892955, -0.9898759, -0.9902628,
  -0.9907142, -0.9909076, -0.9908431, -0.9905207, -0.9910366, -0.9916814, -0.9922618, -0.9927777, -0.9931646, -0.9933581,
  -0.9934225, -0.9947767, -0.9943898, -0.9934870, -0.9932291, -0.9929711, -0.9927132, -0.9925197, -0.9924553, -0.9923908,
  -0.9922618, -0.9921973, -0.9920684, -0.9919394, -0.9918104, -0.9916170, -0.9914235, -0.9912300, -0.9911011, -0.9909076,
  -0.9907787, -0.9905852, -0.9904562, -0.9902628, -0.9901338, -0.9899404, -0.9897469, -0.9894890, -0.9892310, -0.9890376,
  -0.9887796, -0.9885217, -0.9883927, -0.9883282, -0.9882637, -0.9883927, -0.9885217, -0.9887151, -0.9888441, -0.9889086,
  -0.9890376, -0.9891665, -0.9892955, -0.9894245, -0.9891665, -0.9887151, -0.9883282, -0.9879413, -0.9874899, -0.9871675,
  -0.9859423, -0.9848460, -0.9842012, -0.9836853, -0.9829760, -0.9823311, -0.9822022, -0.9825246, -0.9831049, -0.9832339,
  -0.9814283, -0.9787845, -0.9756892, -0.9747219, -0.9745285, -0.9745285, -0.9740126, -0.9734322, -0.9728518, -0.9721425,
  -0.9715621, -0.9715621, -0.9718201, -0.9720780, -0.9724005, -0.9724005, -0.9718846, -0.9713687, -0.9707883, -0.9702724,
  -0.9696921, -0.9693052, -0.9689183, -0.9686603, -0.9683379, -0.9678220, -0.9675641, -0.9673706, -0.9671127, -0.9668547,
  -0.9665968, -0.9662744, -0.9660164, -0.9658230, -0.9657585, -0.9658230, -0.9658875, -0.9659520, -0.9660164, -0.9660809,
  -0.9661454, -0.9662099, -0.9664034, -0.9665968, -0.9668547, -0.9670482, -0.9673061, -0.9674996, -0.9677575, -0.9681444,
  -0.9685314, -0.9689828, -0.9691762, -0.9689183, -0.9684669, -0.9680155, -0.9673061, -0.9659520, -0.9645978, -0.9637595,
  -0.9630501, -0.9624053, -0.9616960, -0.9613090, -0.9611801, -0.9610511, -0.9607932, -0.9607932, -0.9609866, -0.9612446,
  -0.9615670, -0.9618249, -0.9621473, -0.9624053, -0.9626632, -0.9627277, -0.9624053, -0.9621473, -0.9618249, -0.9615025,
  -0.9611801, -0.9606642, -0.9602128, -0.9597614, -0.9593100, -0.9589231, -0.9589231, -0.9589876, -0.9588586, -0.9587296,
  -0.9584072, -0.9580848, -0.9579558, -0.9579558, -0.9582783, -0.9586007, -0.9582783, -0.9578913, -0.9575044, -0.9572465,
  -0.9569886, -0.9569886, -0.9573755, -0.9577624, -0.9580848, -0.9591810, -0.9603418, -0.9614380, -0.9625343, -0.9635660,
  -0.9647267, -0.9655006, -0.9660164, -0.9665323, -0.9668547, -0.9670482, -0.9675641, -0.9683379, -0.9689828, -0.9695631,
  -0.9701435, -0.9704014, -0.9698211, -0.9691117, -0.9687248, -0.9682089, -0.9676286, -0.9670482, -0.9664678, -0.9658875,
  -0.9653716, -0.9649202, -0.9644043, -0.9642109, -0.9639529, -0.9636950, -0.9634370, -0.9632436, -0.9627922, -0.9625343,
  -0.9622763, -0.9619539, -0.9613090, -0.9606642, -0.9600193, -0.9596324, -0.9597614, -0.9598904, -0.9596324, -0.9595680,
  -0.9595035, -0.9595035, -0.9595035, -0.9595680, -0.9591166, -0.9582783, -0.9574399, -0.9566016, -0.9561502, -0.9562147,
  -0.9558923, -0.9555699, -0.9552475, -0.9551830, -0.9549250, -0.9538933, -0.9527970, -0.9517653, -0.9506690, -0.9496373,
  -0.9487990, -0.9480896, -0.9475093, -0.9472513, -0.9468644, -0.9466710, -0.9465420, -0.9464775, -0.9464130, -0.9459616,
  -0.9453813, -0.9448009, -0.9440916, -0.9433822, -0.9427374, -0.9424150, -0.9420281, -0.9406739, -0.9389328, -0.9372562,
  -0.9362889, -0.9353861, -0.9346768, -0.9336450, -0.9326777, -0.9317749, -0.9313880, -0.9309366, -0.9304208, -0.9299049,
  -0.9288086, -0.9282283, -0.9277769, -0.9273255, -0.9269386, -0.9264227, -0.9257778, -0.9251330, -0.9244882, -0.9236498,
  -0.9228760, -0.9221667, -0.9215863, -0.9212639, -0.9212639, -0.9211994, -0.9208770, -0.9204256, -0.9199742, -0.9195228,
  -0.9190714, -0.9186200, -0.9173303, -0.9160406, -0.9152668, -0.9144285, -0.9135902, -0.9126874, -0.9129453, -0.9130098,
  -0.9131388, -0.9132033, -0.9130098, -0.9121070, -0.9111398, -0.9101080, -0.9091407, -0.9078510, -0.9070772, -0.9063679,
  -0.9055941, -0.9048847, -0.9041109, -0.9034016, -0.9027567, -0.9021764, -0.9019829, -0.9017250, -0.9014025, -0.9010801,
  -0.9010801, -0.9012091, -0.9013381, -0.9014025, -0.9012091, -0.9010156, -0.9008222, -0.9003063, -0.8995325, -0.8987587,
  -0.8979848, -0.8972110, -0.8965662, -0.8959858, -0.8954054, -0.8948251, -0.8944382, -0.8942447, -0.8940513, -0.8937288,
  -0.8930195, -0.8923747, -0.8916653, -0.8910205, -0.8901822, -0.8895373, -0.8896018, -0.8895373, -0.8890214, -0.8883766,
  -0.8879252, -0.8874738, -0.8870224, -0.8873448, -0.8877962, -0.8881831, -0.8886345, -0.8891504, -0.8896663, -0.8898597,
  -0.8892794, -0.8881187, -0.8867000, -0.8857972, -0.8847010, -0.8836047, -0.8828309, -0.8819926, -0.8811543, -0.8803160,
  -0.8795422, -0.8787039, -0.8780590, -0.8774142, -0.8767693, -0.8765114, -0.8763179, -0.8761245, -0.8756731, -0.8753506,
  -0.8749637, -0.8747703, -0.8736095, -0.8723843, -0.8711591, -0.8701918, -0.8692246, -0.8680638, -0.8667741, -0.8654844,
  -0.8644527, -0.8634209, -0.8620023, -0.8606481, -0.8598098, -0.8589715, -0.8583266, -0.8580687, -0.8578752, -0.8576173,
  -0.8572304, -0.8568435, -0.8564566, -0.8556827, -0.8549089, -0.8540706, -0.8531678, -0.8523295, -0.8515557, -0.8509108,
  -0.8503305, -0.8497501, -0.8491053, -0.8487184, -0.8485249, -0.8482670, -0.8479445, -0.8472997, -0.8467193, -0.8460745,
  -0.8457521, -0.8455586, -0.8453651, -0.8450427, -0.8443334, -0.8432371, -0.8425923, -0.8420119, -0.8412381, -0.8405933,
  -0.8403998, -0.8406577, -0.8409157, -0.8412381, -0.8415605, -0.8411736, -0.8403353, -0.8398839, -0.8398194, -0.8387877,
  -0.8378849, -0.8370466, -0.8360793, -0.8352410, -0.8343382, -0.8333065, -0.8323392, -0.8314364, -0.8305336, -0.8296308,
  -0.8286635, -0.8276963, -0.8267290, -0.8256972, -0.8235048, -0.8215057, -0.8195712, -0.8186039, -0.8175721, -0.8166049,
  -0.8154441, -0.8142189, -0.8137030, -0.8133161, -0.8129292, -0.8128647, -0.8125423, -0.8121554, -0.8117040, -0.8111881,
  -0.8104788, -0.8099629, -0.8094470, -0.8089312, -0.8082863, -0.8077059, -0.8070611, -0.8064163, -0.8051910, -0.8038369,
  -0.8024827, -0.8011285, -0.7999678, -0.7995164, -0.7990005, -0.7985491, -0.7980977, -0.7977108, -0.7972594, -0.7968725,
  -0.7963566, -0.7958407, -0.7953248, -0.7947445, -0.7942931, -0.7939062, -0.7929389, -0.7919071, -0.7909399, -0.7898436,
  -0.7888119, -0.7877801, -0.7868128, -0.7859745, -0.7848783, -0.7836531, -0.7826213, -0.7815896, -0.7806868, -0.7795905,
  -0.7786877, -0.7774625, -0.7760438, -0.7750766, -0.7757214, -0.7770756, -0.7783008, -0.7798485, -0.7785588, -0.7766887,
  -0.7748831, -0.7737869, -0.7730131, -0.7722392, -0.7714654, -0.7706916, -0.7701757, -0.7697888, -0.7695954, -0.7695309,
  -0.7691440, -0.7683701, -0.7674674, -0.7665646, -0.7656618, -0.7645655, -0.7639852, -0.7633403, -0.7628244, -0.7621796,
  -0.7607609, -0.7597936, -0.7588264, -0.7578591, -0.7568273, -0.7557956, -0.7548928, -0.7538610, -0.7532807, -0.7527003,
  -0.7520555, -0.7514106, -0.7507658, -0.7501854, -0.7496050, -0.7491536, -0.7485733, -0.7480574, -0.7473481, -0.7466387,
  -0.7459294, -0.7452201, -0.7447042, -0.7439304, -0.7430276, -0.7422537, -0.7412220, -0.7398033, -0.7383847, -0.7370950,
  -0.7359987, -0.7349670, -0.7338707, -0.7324520, -0.7310334, -0.7296147, -0.7280026, -0.7263905, -0.7247783, -0.7231017,
  -0.7218765, -0.7207803, -0.7195551, -0.7178784, -0.7162663, -0.7152990, -0.7142673, -0.7132355, -0.7122038, -0.7111720,
  -0.7102047, -0.7093664, -0.7085926, -0.7078188, -0.7069160, -0.7059487, -0.7049815, -0.7041432, -0.7031759, -0.7018217,
  -0.7003385, -0.6989199, -0.6975012, -0.6958891, -0.6938256, -0.6917621, -0.6897630, -0.6878285, -0.6859584, -0.6840239,
  -0.6827986, -0.6811865, -0.6795744, -0.6791875, -0.6783492, -0.6773819, -0.6760922, -0.6748025, -0.6735128, -0.6723521,
  -0.6717072, -0.6711269, -0.6700951, -0.6689344, -0.6675802, -0.6661615, -0.6646784, -0.6631952, -0.6633242, -0.6631307,
  -0.6616476, -0.6597130, -0.6581654, -0.6574561, -0.6566823, -0.6558439, -0.6550701, -0.6543608, -0.6535870, -0.6528132,
  -0.6521038, -0.6509431, -0.6494599, -0.6481058, -0.6466871, -0.6453329, -0.6444946, -0.6437208, -0.6428180, -0.6419152,
  -0.6412059, -0.6404320, -0.6395937, -0.6384330, -0.6366919, -0.6348863, -0.6335322, -0.6327583, -0.6315976, -0.6305659,
  -0.6295986, -0.6284379, -0.6268902, -0.6252781, -0.6242463, -0.6232791, -0.6223118, -0.6212800, -0.6202483, -0.6192810,
  -0.6184427, -0.6175399, -0.6166371, -0.6157343, -0.6148960, -0.6140577, -0.6129615, -0.6118652, -0.6107690, -0.6096727,
  -0.6087700, -0.6079316, -0.6070933, -0.6059971, -0.6045784, -0.6030308, -0.6013542, -0.5994841, -0.5974851, -0.5954861,
  -0.5940029, -0.5929711, -0.5918749, -0.5904562, -0.5892310, -0.5882637, -0.5872320, -0.5859423, -0.5845236, -0.5829115,
  -0.5812994, -0.5800742, -0.5789134, -0.5778817, -0.5767854, -0.5756892, -0.5745929, -0.5736257, -0.5725939, -0.5714332,
  -0.5700790, -0.5687893, -0.5673061, -0.5656295, -0.5639529, -0.5620829, -0.5611801, -0.5605997, -0.5600838, -0.5596324,
  -0.5591810, -0.5587296, -0.5582783, -0.5580848, -0.5580203, -0.5581493, -0.5582783, -0.5586007, -0.5591166, -0.5595680,
  -0.5591166, -0.5586007, -0.5582138, -0.5578913, -0.5576334, -0.5574399, -0.5566661, -0.5558923, -0.5550540, -0.5543447,
  -0.5536998, -0.5530550, -0.5524101, -0.5515718, -0.5506045, -0.5497662, -0.5488635, -0.5475093, -0.5460261, -0.5446074,
  -0.5437691, -0.5429308, -0.5421570, -0.5417056, -0.5413832, -0.5407384, -0.5400290, -0.5390617, -0.5379010, -0.5367403,
  -0.5360954, -0.5353861, -0.5343543, -0.5333871, -0.5322908, -0.5310656, -0.5298404, -0.5288086, -0.5277769, -0.5268096,
  -0.5258423, -0.5248106, -0.5237788, -0.5228115, -0.5217153, -0.5208125, -0.5204901, -0.5197808, -0.5190069, -0.5182976,
  -0.5175883, -0.5171369, -0.5168144, -0.5158472, -0.5138481, -0.5121715, -0.5108818, -0.5095276, -0.5086249, -0.5077866,
  -0.5067548, -0.5056586, -0.5048202, -0.5039175, -0.5017895, -0.4995970, -0.4983718, -0.4974690, -0.4964372, -0.4954699,
  -0.4948251, -0.4928261, -0.4909560, -0.4887635, -0.4863776, -0.4840561, -0.4819281, -0.4797356, -0.4776721, -0.4763824,
  -0.4750927, -0.4738030, -0.4725778, -0.4713526, -0.4701274, -0.4688377, -0.4674190, -0.4665807, -0.4667097, -0.4671611,
  -0.4672900, -0.4656134, -0.4640013, -0.4627116, -0.4612929, -0.4598743, -0.4582621, -0.4574883, -0.4567790, -0.4567790,
  -0.4563276, -0.4556827, -0.4551024, -0.4545220, -0.4540061, -0.4532323, -0.4525230, -0.4516847, -0.4506529, -0.4489118,
  -0.4471707, -0.4455586, -0.4442689, -0.4434951, -0.4426568, -0.4418830, -0.4416250, -0.4413026, -0.4398839, -0.4363373,
  -0.4324037, -0.4314364, -0.4309205, -0.4302112, -0.4293729, -0.4284701, -0.4276963, -0.4268580, -0.4262131, -0.4249879,
  -0.4235692, -0.4226665, -0.4216992, -0.4206674, -0.4196357, -0.4191843, -0.4191843, -0.4193777, -0.4175721, -0.4153152,
  -0.4130582, -0.4108657, -0.4089956, -0.4064807, -0.4044172, -0.4023537, -0.4002902, -0.3988070, -0.3972594, -0.3959052,
  -0.3943576, -0.3904885, -0.3865549, -0.3839755, -0.3814606, -0.3792036, -0.3770756, -0.3751411, -0.3736579, -0.3713365,
  -0.3683701, -0.3634693, -0.3603740, -0.3583105, -0.3564404, -0.3544414, -0.3524424, -0.3507658, -0.3495405, -0.3489602,
  -0.3481219, -0.3465742, -0.3445107, -0.3423827, -0.3407061, -0.3393519, -0.3381267, -0.3371594, -0.3358053, -0.3343866,
  -0.3332903, -0.3321941, -0.3310979, -0.3294212, -0.3267129, -0.3240045, -0.3232307, -0.3218765, -0.3192971, -0.3183298,
  -0.3175560, -0.3159439, -0.3143963, -0.3133000, -0.3130421, -0.3132355, -0.3163308, -0.3174915, -0.3176850, -0.3165887,
  -0.3122683, -0.3062067, -0.2996292, -0.2928583, -0.2866033, -0.2831856, -0.2816379, -0.2780912, -0.2724811, -0.2688699,
  -0.2658391, -0.2620990, -0.2584233, -0.2568757, -0.2555215, -0.2539094, -0.2510721, -0.2486861, -0.2465581, -0.2423021,
  -0.2355312, -0.2307593, -0.2270837, -0.2238594, -0.2212800, -0.2194100, -0.2177334, -0.2163147, -0.2143801, -0.2128970,
  -0.2118007, -0.2109624, -0.2104466, -0.2101241, -0.2096727, -0.2090279, -0.2079961, -0.2063195, -0.2027084, -0.1992907,
  -0.1967113, -0.1937450, -0.1887796, -0.1843302, -0.1803966, -0.1778817, -0.1754957, -0.1723360, -0.1688538, -0.1656295,
  -0.1628567, -0.1596969, -0.1563437, -0.1533774, -0.1509270, -0.1488635, -0.1469289, -0.1451878, -0.1428664, -0.1401580,
  -0.1399645, -0.1443495, -0.1461551, -0.1462841, -0.1460261, -0.1452523, -0.1428019, -0.1408028, -0.1391907, -0.1377076,
  -0.1369337, -0.1362244, -0.1355796, -0.1350637, -0.1357730, -0.1355796, -0.1310656, -0.1244237, -0.1206191, -0.1173303,
  -0.1141706, -0.1110108, -0.1083669, -0.1069483, -0.1056586, -0.1044978, -0.1019184, -0.0985652, -0.0966307, -0.0925036,
  -0.0891504, -0.0856682, -0.0817991, -0.0775431, -0.0728357, -0.0692246, -0.0651620, -0.0607126, -0.0565855, -0.0527809,
  -0.0498791, -0.0473642, -0.0442044, -0.0388522, -0.0324682, -0.0310495, -0.0280187, -0.0229244, -0.0186039, -0.0147993,
  -0.0132517, -0.0109947, -0.0083508, -0.0049331, -0.0012575, 0.0009350, 0.0021602, 0.0028051, 0.0037079, 0.0047396,
  0.0059649, 0.0089956, 0.0137030, 0.0178946, 0.0213768, 0.0241496, 0.0269869, 0.0309850, 0.0361438, 0.0403998,
  0.0461390, 0.0500725, 0.0537482, 0.0585201, 0.0605836, 0.0627116, 0.0655489, 0.0701274, 0.0742544, 0.0779300,
  0.0815412, 0.0855393, 0.0892149, 0.0933419, 0.0958568, 0.0984362, 0.1014025, 0.1053361, 0.1111398, 0.1148799,
  0.1177172, 0.1225536, 0.1250040, 0.1275834, 0.1302918, 0.1323553, 0.1359020, 0.1390617, 0.1425439, 0.1460261,
  0.1511204, 0.1559568, 0.1602128, 0.1643398, 0.1679510, 0.1696276, 0.1716911, 0.1740126, 0.1758182, 0.1791069,
  0.1823311, 0.1863292, 0.1901983, 0.1937450, 0.1964533, 0.1984524, 0.2027084, 0.2082541, 0.2124456, 0.2145736,
  0.2167016, 0.2186361, 0.2228921, 0.2267612, 0.2292762, 0.2326294, 0.2360471, 0.2413348, 0.2466871, 0.2515235,
  0.2566178, 0.2610672, 0.2646139, 0.2682895, 0.2729325, 0.2783492, 0.2818959, 0.2858939, 0.2902144, 0.2937611,
  0.2976947, 0.3026600, 0.3082057, 0.3134290, 0.3184588, 0.3266484, 0.3336773, 0.3387071, 0.3423827, 0.3467032,
  0.3504433, 0.3542479, 0.3577946, 0.3608899, 0.3650169, 0.3682412, 0.3727551, 0.3746897, 0.3803643, 0.3848138,
  0.3890698, 0.3941641, 0.3970015, 0.3999678, 0.4042882, 0.4084153, 0.4118975, 0.4161535, 0.4216347, 0.4272449,
  0.4319523, 0.4372400, 0.4423988, 0.4468483, 0.4508464, 0.4558117, 0.4613574, 0.4661938, 0.4703853, 0.4751572,
  0.4796711, 0.4847654, 0.4908915, 0.4972755, 0.5019829, 0.5077866, 0.5125584, 0.5172658, 0.5206191, 0.5273900,
  0.5377720, 0.5436402, 0.5478317, 0.5516363, 0.5555699, 0.5609866, 0.5669192, 0.5710463, 0.5760116, 0.5829760,
  0.5882637, 0.5925842, 0.5958085, 0.6000000, 0.6048364, 0.6098017, 0.6147026, 0.6193455, 0.6236660, 0.6300500,
  0.6349508, 0.6406900, 0.6509431, 0.6542963, 0.6561019, 0.6606803, 0.6628083, 0.6659036, 0.6688054, 0.6719652,
  0.6764146, 0.6832500, 0.6881509, 0.6929873, 0.7015638, 0.7158149, 0.7224569, 0.7269063, 0.7321296, 0.7387071,
  0.7431565, 0.7468967, 0.7553442, 0.7609544, 0.7649524, 0.7697243, 0.7747542, 0.7790746, 0.7860390, 0.7904885,
  0.7940351, 0.7966145, 0.7995808, 0.8053200, 0.8107367, 0.8155086, 0.8196357, 0.8226020, 0.8259552, 0.8303402,
  0.8353700, 0.8397550, 0.8431082, 0.8465904, 0.8502660, 0.8537482, 0.8567145, 0.8599387, 0.8638078, 0.8676124,
  0.8715460, 0.8755441, 0.8803160, 0.8857972, 0.8908915, 0.8958568, 0.9039819, 0.9084314, 0.9128809, 0.9173303,
  0.9217153, 0.9266806, 0.9311946, 0.9357730, 0.9406739, 0.9449944, 0.9498307, 0.9549895, 0.9589231, 0.9635015,
  0.9691117, 0.9747219, 0.9797517, 0.9838143, 0.9900693, 0.9949057, 0.9980010, 1.0000000, 0.9999355, 0.9985168,
  0.9914235, 0.9878123, 0.9830405, 0.9777527, 0.9729808, 0.9671772, 0.9616315, 0.9551830, 0.9471224, 0.9433822,
  0.9401580, 0.9372562, 0.9355796, 0.9342899, 0.9328712, 0.9317749, 0.9315815, 0.9334516, 0.9348057, 0.9362244,
  0.9409318, 0.9429308, 0.9428019, 0.9404804, 0.9319684, 0.9275189, 0.9214574, 0.9198452, 0.9181686, 0.9175883,
  0.9164920, 0.9155892, 0.9156537, 0.9156537, 0.9161696, 0.9173948, 0.9186200, 0.9198452, 0.9218443, 0.9237143,
  0.9257778, 0.9293890, 0.9357085, 0.9427374, 0.9480896, 0.9522167, 0.9564082, 0.9600838, 0.9673061, 0.9689183,
  0.9722070, 0.9732388, 0.9741415, 0.9740126, 0.9730453, 0.9711752, 0.9684669, 0.9651137, 0.9607287, 0.9586652,
  0.9567951, 0.9546671, 0.9497662, 0.9441561, 0.9394487, 0.9352571, 0.9303563, 0.9265517, 0.9227471, 0.9185555,
  0.9130743, 0.9074641, 0.9026922, 0.8978559, 0.8937933, 0.8897953, 0.8855393, 0.8810898, 0.8772852, 0.8722554,
  0.8679994, 0.8629695, 0.8589715, 0.8545865, 0.8499436, 0.8458810, 0.8420119, 0.8382718, 0.8338868, 0.8298888,
  0.8267935, 0.8235692, 0.8202805, 0.8167983, 0.8128647, 0.8082218, 0.8042238, 0.8010640, 0.7979687, 0.7946155,
  0.7908109, 0.7869418, 0.7820409, 0.7777849, 0.7746252, 0.7707561, 0.7666291, 0.7633403, 0.7605675, 0.7558601,
  0.7523779, 0.7497340, 0.7468322, 0.7435434, 0.7398678, 0.7366436, 0.7335483, 0.7303240, 0.7260035, 0.7208448,
  0.7169112, 0.7129131, 0.7089150, 0.7059487, 0.7027890, 0.6986619, 0.6946639, 0.6915041, 0.6878930, 0.6835080,
  0.6797679, 0.6760277, 0.6717717, 0.6668064, 0.6624214, 0.6591972, 0.6553926, 0.6508141, 0.6477188, 0.6446881,
  0.6401741, 0.6359181, 0.6322425, 0.6293406, 0.6260519, 0.6217959, 0.6191520, 0.6161212, 0.6119297, 0.6077382,
  0.6039336, 0.5996131, 0.5959374, 0.5924553, 0.5894245, 0.5860068, 0.5821377, 0.5783331, 0.5745929, 0.5712397,
  0.5674996, 0.5639529, 0.5606642, 0.5576334, 0.5549895, 0.5500887, 0.5458327, 0.5427374, 0.5395131, 0.5360954,
  0.5318394, 0.5275189, 0.5241012, 0.5206191, 0.5170724, 0.5121070, 0.5081735, 0.5061744, 0.5039175, 0.5004353,
  0.4959858, 0.4921812, 0.4888925, 0.4863131, 0.4835402, 0.4808963, 0.4781235, 0.4744478, 0.4699339, 0.4672900,
  0.4644527, 0.4609060, 0.4572304, 0.4534902, 0.4497501, 0.4461390, 0.4428502, 0.4397550, 0.4367242, 0.4336934,
  0.4304691, 0.4264711, 0.4225375, 0.4189263, 0.4164759, 0.4140900, 0.4115106, 0.4076415, 0.4037079, 0.3997098,
  0.3957762, 0.3921006, 0.3891988, 0.3867483, 0.3857811, 0.3843624, 0.3827503, 0.3806868, 0.3781074, 0.3743028,
  0.3712075, 0.3683057, 0.3654683, 0.3627600, 0.3601161, 0.3576656, 0.3552152, 0.3530227, 0.3510882, 0.3489602,
  0.3463163, 0.3427696, 0.3396744, 0.3368370, 0.3339352, 0.3308399, 0.3278736, 0.3251008, 0.3219410, 0.3189747,
  0.3160084, 0.3128486, 0.3097533, 0.3074964, 0.3054973, 0.3031759, 0.2996292, 0.2957601, 0.2932452, 0.2905368,
  0.2875060, 0.2841528, 0.2809931, 0.2776399, 0.2748670, 0.2722876, 0.2698372, 0.2663550, 0.2630018, 0.2601000,
  0.2571981, 0.2535225, 0.2501693, 0.2475254, 0.2448170, 0.2409479, 0.2371433, 0.2342415, 0.2312752, 0.2280509,
  0.2248267, 0.2216025, 0.2181847, 0.2156698, 0.2130904, 0.2099952, 0.2065130, 0.2036756, 0.2009673, 0.1983879,
  0.1959374, 0.1935515, 0.1894890, 0.1859423, 0.1834919, 0.1810414, 0.1772368, 0.1724649, 0.1691117, 0.1655650,
  0.1617604, 0.1584072, 0.1554409, 0.1530550, 0.1509270, 0.1493793, 0.1483476, 0.1464130, 0.1445430, 0.1426084,
  0.1400290, 0.1373851, 0.1350637, 0.1327422, 0.1296469, 0.1265517, 0.1233274, 0.1213284, 0.1188780, 0.1159761,
  0.1124940, 0.1092697, 0.1070772, 0.1052072, 0.1033371, 0.1008222, 0.0981138, 0.0952120, 0.0923102, 0.0893439,
  0.0857327, 0.0836692, 0.0810898, 0.0774786, 0.0741254, 0.0702563, 0.0690956, 0.0681283, 0.0667741, 0.0652265,
  0.0637433, 0.0604546, 0.0576173, 0.0555538, 0.0538772, 0.0525230, 0.0514912, 0.0494277, 0.0467838, 0.0437530,
  0.0412381, 0.0387232, 0.0340158, 0.0307271, 0.0287925, 0.0264711, 0.0250524, 0.0248589, 0.0244075, 0.0220216,
  0.0218281, 0.0213123, 0.0194422, 0.0181525, 0.0158310, 0.0131872, 0.0101564, 0.0077059, 0.0053845, 0.0033855,
  0.0010640, -0.0009995, -0.0022892, -0.0029341, -0.0035789, -0.0043527, -0.0052555, -0.0068032, -0.0082863, -0.0097695,
  -0.0113816, -0.0129292, -0.0150572, -0.0183460, -0.0213123, -0.0238917, -0.0267935, -0.0278252, -0.0288570, -0.0302112,
  -0.0312429, -0.0323392, -0.0349831, -0.0375625, -0.0400129, -0.0423344, -0.0450427, -0.0470418, -0.0487828, -0.0504595,
  -0.0522005, -0.0542641, -0.0564566, -0.0585846, -0.0603256, -0.0621312, -0.0640013, -0.0658069, -0.0676124, -0.0694825,
  -0.0712881, -0.0733516, -0.0754151, -0.0772207, -0.0789618, -0.0806384, -0.0822505, -0.0839271, -0.0856037, -0.0873448,
  -0.0890859, -0.0908270, -0.0932774, -0.0957924, -0.0983718, -0.1007577, -0.1030792, -0.1054006, -0.1078510, -0.1101725,
  -0.1115267, -0.1128164, -0.1139771, -0.1152023, -0.1165565, -0.1188135, -0.1210704, -0.1231340, -0.1255199, -0.1279059,
  -0.1299694, -0.1318394, -0.1337095, -0.1355151, -0.1374496, -0.1394487, -0.1414477, -0.1437047, -0.1455102, -0.1469934,
  -0.1486055, -0.1500887, -0.1516363, -0.1531839, -0.1547316, -0.1564727, -0.1584072, -0.1602773, -0.1621473, -0.1637595,
  -0.1658230, -0.1678220, -0.1698211, -0.1718846, -0.1740126, -0.1758826, -0.1776237, -0.1794293, -0.1813639, -0.1843946,
  -0.1873610, -0.1894890, -0.1916170, -0.1938094, -0.1958085, -0.1977430, -0.1998710, -0.2018056, -0.2033532, -0.2046429,
  -0.2060616, -0.2077382, -0.2098662, -0.2116073, -0.2134129, -0.2158633, -0.2182492, -0.2204417, -0.2223118, -0.2241818,
  -0.2261164, -0.2279220, -0.2295986, -0.2309528, -0.2319845, -0.2328228, -0.2348863, -0.2372723, -0.2392713, -0.2403031,
  -0.2413348, -0.2424311, -0.2441077, -0.2456553, -0.2467516, -0.2481058, -0.2495889, -0.2511365, -0.2529421, -0.2548122,
  -0.2566178, -0.2583589, -0.2606803, -0.2630018, -0.2651298, -0.2662260, -0.2675157, -0.2688699, -0.2701596, -0.2715783,
  -0.2740287, -0.2759632, -0.2780912, -0.2794454, -0.2808641, -0.2824117, -0.2839594, -0.2857650, -0.2876350, -0.2895051,
  -0.2913107, -0.2931162, -0.2949218, -0.2967274, -0.2986619, -0.3006610, -0.3026600, -0.3044011, -0.3058842, -0.3073029,
  -0.3086571, -0.3100113, -0.3112365, -0.3125907, -0.3139449, -0.3146542, -0.3156215, -0.3174915, -0.3189747, -0.3204578,
  -0.3213606, -0.3229728, -0.3242625, -0.3255522, -0.3269063, -0.3282605, -0.3296792, -0.3313558, -0.3332259, -0.3350314,
  -0.3370305, -0.3389650, -0.3408351, -0.3423827, -0.3435434, -0.3445107, -0.3459939, -0.3480574, -0.3503144, -0.3525713,
  -0.3545704, -0.3563115, -0.3579881, -0.3596002, -0.3612123, -0.3630824, -0.3650814, -0.3670804, -0.3692084, -0.3714009,
  -0.3735934, -0.3755280, -0.3773335, -0.3790102, -0.3807512, -0.3822344, -0.3833951, -0.3844269, -0.3852652, -0.3859745,
  -0.3866194, -0.3875222, -0.3892633, -0.3911978, -0.3926165, -0.3936482, -0.3946800, -0.3956473, -0.3968080, -0.3979687,
  -0.3992584, -0.4005481, -0.4020958, -0.4035789, -0.4051266, -0.4066742, -0.4076415, -0.4086087, -0.4095760, -0.4105433,
  -0.4115106, -0.4124133, -0.4134451, -0.4149283, -0.4164114, -0.4179591, -0.4195712, -0.4215702, -0.4235048, -0.4249879,
  -0.4260842, -0.4270514, -0.4280832, -0.4293729, -0.4305336, -0.4314364, -0.4322747, -0.4330485, -0.4340158, -0.4350476,
  -0.4361438, -0.4373690, -0.4383363, -0.4394325, -0.4408512, -0.4423344, -0.4443334, -0.4461390, -0.4476221, -0.4491053,
  -0.4509108, -0.4525875, -0.4540061, -0.4553603, -0.4567145, -0.4580687, -0.4589070, -0.4596808, -0.4604546, -0.4612284,
  -0.4620667, -0.4629050, -0.4638078, -0.4647106, -0.4679349, -0.4705143, -0.4721909, -0.4740609, -0.4763179, -0.4783814,
  -0.4798646, -0.4813477, -0.4828954, -0.4838626, -0.4848299, -0.4859262, -0.4869579, -0.4885056, -0.4901822, -0.4917298,
  -0.4932774, -0.4948896, -0.4965662, -0.4986942, -0.5010801, -0.5034661, -0.5048202, -0.5061744, -0.5075286, -0.5088828,
  -0.5102370, -0.5118491, -0.5132678, -0.5146864, -0.5161051, -0.5172014, -0.5182331, -0.5192649, -0.5202966, -0.5213284,
  -0.5223601, -0.5239078, -0.5258423, -0.5278414, -0.5294535, -0.5310011, -0.5322908, -0.5334516, -0.5345478, -0.5355796,
  -0.5377076, -0.5397711, -0.5408028, -0.5417701, -0.5425439, -0.5437691, -0.5448654, -0.5458327, -0.5462841, -0.5468644,
  -0.5475738, -0.5489279, -0.5504756, -0.5520877, -0.5537643, -0.5553119, -0.5568596, -0.5584072, -0.5599549, -0.5615025,
  -0.5632436, -0.5649847, -0.5670482, -0.5690472, -0.5715621, -0.5727229, -0.5720780, -0.5716911, -0.5711752, -0.5708528,
  -0.5716266, -0.5723360, -0.5731098, -0.5738191, -0.5747219, -0.5758182, -0.5769789, -0.5784620, -0.5798807, -0.5812994,
  -0.5825891, -0.5839433, -0.5852330, -0.5865227, -0.5879413, -0.5895534, -0.5911011, -0.5927132, -0.5941964, -0.5958085,
  -0.5974206, -0.5989682, -0.6005159, -0.6016121, -0.6027084, -0.6038046, -0.6049009, -0.6059971, -0.6071578, -0.6082541,
  -0.6094148, -0.6105755, -0.6116718, -0.6128325, -0.6139287, -0.6150895, -0.6162502, -0.6174754, -0.6188296, -0.6200548,
  -0.6211511, -0.6222473, -0.6232791, -0.6242463, -0.6251491, -0.6259874, -0.6270837, -0.6281154, -0.6290182, -0.6299855,
  -0.6309528, -0.6315331, -0.6321780, -0.6331453, -0.6349508, -0.6367564, -0.6384330, -0.6394648, -0.6403676, -0.6408834,
  -0.6417217, -0.6426890, -0.6434628, -0.6441722, -0.6449460, -0.6458488, -0.6467516, -0.6476544, -0.6485571, -0.6489441,
  -0.6488796, -0.6490730, -0.6492665, -0.6493955, -0.6496534, -0.6499113, -0.6504272, -0.6509431, -0.6515879, -0.6524262,
  -0.6536515, -0.6548122, -0.6555860, -0.6561019, -0.6567467, -0.6575850, -0.6588103, -0.6606158, -0.6620345, -0.6621635,
  -0.6624214, -0.6628083, -0.6633887, -0.6640335, -0.6646139, -0.6653877, -0.6662905, -0.6670643, -0.6675802, -0.6683540,
  -0.6691278, -0.6700306, -0.6709979, -0.6719007, -0.6727390, -0.6736418, -0.6746091, -0.6755118, -0.6761567, -0.6768015,
  -0.6775109, -0.6782847, -0.6791230, -0.6798968, -0.6807351, -0.6815089, -0.6822828, -0.6831211, -0.6838949, -0.6846042,
  -0.6853136, -0.6860229, -0.6867322, -0.6874416, -0.6880219, -0.6885378, -0.6893116, -0.6900210, -0.6905368, -0.6913107,
  -0.6921490, -0.6929873, -0.6937611, -0.6945349, -0.6952442, -0.6959536, -0.6966629, -0.6972433, -0.6974367, -0.6978881,
  -0.6984685, -0.6989199, -0.6995002, -0.7002741, -0.7010479, -0.7018217, -0.7025955, -0.7034338, -0.7043366, -0.7053039,
  -0.7062067, -0.7071095, -0.7080767, -0.7089795, -0.7100113, -0.7106561, -0.7112365, -0.7117524, -0.7123972, -0.7133000,
  -0.7141383, -0.7149766, -0.7157504, -0.7164598, -0.7170401, -0.7176205, -0.7182009, -0.7189102, -0.7195551, -0.7202644,
  -0.7209092, -0.7217475, -0.7223924, -0.7231017, -0.7242625, -0.7251652, -0.7255522, -0.7258746, -0.7261970, -0.7265839,
  -0.7269063, -0.7272288, -0.7273577, -0.7275512, -0.7276802, -0.7283895, -0.7292278, -0.7298082, -0.7305175, -0.7312913,
  -0.7319362, -0.7325810, -0.7331614, -0.7339352, -0.7346445, -0.7347735, -0.7350314, -0.7357408, -0.7367725, -0.7379333,
  -0.7390295, -0.7401902, -0.7412220, -0.7418668, -0.7427051, -0.7435434, -0.7443818, -0.7452201, -0.7459939, -0.7467677,
  -0.7475415, -0.7483153, -0.7491536, -0.7500564, -0.7510237, -0.7519910, -0.7529582, -0.7539255, -0.7548928, -0.7556021,
  -0.7562470, -0.7569563, -0.7576656, -0.7583750, -0.7590843, -0.7598581, -0.7605675, -0.7612768, -0.7620506, -0.7628244,
  -0.7635983, -0.7643721, -0.7652104, -0.7659842, -0.7667580, -0.7675318, -0.7682412, -0.7689505, -0.7696598, -0.7703692,
  -0.7710785, -0.7717234, -0.7724327, -0.7730775, -0.7737869, -0.7744962, -0.7753345, -0.7761728, -0.7770111, -0.7778494,
  -0.7787522, -0.7795905, -0.7804933, -0.7812671, -0.7819765, -0.7826858, -0.7833951, -0.7840400, -0.7847493, -0.7854586,
  -0.7861680, -0.7866839, -0.7873287, -0.7879736, -0.7886184, -0.7892633, -0.7899726, -0.7906174, -0.7913268, -0.7920361,
  -0.7927454, -0.7935193, -0.7941641, -0.7948734, -0.7955828, -0.7962276, -0.7969370, -0.7976463, -0.7983556, -0.7991295,
  -0.7998388, -0.8004836, -0.8010640, -0.8016444, -0.8022892, -0.8029341, -0.8035789, -0.8042238, -0.8047396, -0.8052555,
  -0.8057714, -0.8064163, -0.8071901, -0.8080284, -0.8088022, -0.8096405, -0.8103498, -0.8109302, -0.8114461, -0.8120909,
  -0.8127358, -0.8134451, -0.8140900, -0.8147348, -0.8154441, -0.8160890, -0.8167338, -0.8174432, -0.8180880, -0.8187329,
  -0.8193777, -0.8200871, -0.8207319, -0.8213768, -0.8220216, -0.8226665, -0.8233113, -0.8239562, -0.8246010, -0.8252458,
  -0.8258907, -0.8265355, -0.8271804, -0.8278897, -0.8285346, -0.8292439, -0.8299532, -0.8306626, -0.8313719, -0.8320168,
  -0.8327261, -0.8333709, -0.8340158, -0.8347251, -0.8353700, -0.8360148, -0.8367242, -0.8373690, -0.8380783, -0.8387232,
  -0.8393036, -0.8399484, -0.8405933, -0.8412381, -0.8418185, -0.8424633, -0.8430437, -0.8435596, -0.8440110, -0.8444624,
  -0.8448493, -0.8453007, -0.8457521, -0.8462034, -0.8467193, -0.8471062, -0.8474931, -0.8478801, -0.8485249, -0.8491698,
  -0.8498791, -0.8502015, -0.8505239, -0.8509753, -0.8517492, -0.8523940, -0.8530389, -0.8537482, -0.8544575, -0.8551024,
  -0.8554893, -0.8556827, -0.8558117, -0.8559407, -0.8561986, -0.8566500, -0.8569724, -0.8574883, -0.8579397, -0.8584556,
  -0.8589715, -0.8594873, -0.8600677, -0.8606481, -0.8611640, -0.8616798, -0.8621957, -0.8627116, -0.8632275, -0.8638078,
  -0.8643237, -0.8647751, -0.8652910, -0.8657424, -0.8661938, -0.8666452, -0.8670966, -0.8676124, -0.8681283, -0.8684507,
  -0.8689666, -0.8694180, -0.8698694, -0.8703208, -0.8708367, -0.8713526, -0.8719974, -0.8726423, -0.8732871, -0.8738675,
  -0.8744478, -0.8750927, -0.8756731, -0.8762534, -0.8768983, -0.8774786, -0.8779300, -0.8783814, -0.8788328, -0.8792842,
  -0.8797356, -0.8801870, -0.8806384, -0.8810898, -0.8816057, -0.8821216, -0.8825729, -0.8830888, -0.8836047, -0.8841851,
  -0.8847654, -0.8850879, -0.8854748, -0.8858617, -0.8862486, -0.8866355, -0.8870869, -0.8874738, -0.8878607, -0.8882476,
  -0.8886345, -0.8889570, -0.8892794, -0.8896018, -0.8899887, -0.8906980, -0.8914074, -0.8921812, -0.8929550, -0.8937288,
  -0.8943737, -0.8949541, -0.8955344, -0.8960503, -0.8965662, -0.8970176, -0.8973400, -0.8977269, -0.8980493, -0.8984362,
  -0.8987587, -0.8991456, -0.8994680, -0.8997904, -0.9002418, -0.9006932, -0.9010156, -0.9012736, -0.9016605, -0.9019829,
  -0.9023698, -0.9027567, -0.9031436, -0.9035305, -0.9039819, -0.9044333, -0.9044978, -0.9040464, -0.9035305, -0.9032726,
  -0.9036595, -0.9041109, -0.9045623, -0.9050782, -0.9055941, -0.9060455, -0.9064969, -0.9069483, -0.9073996, -0.9080445,
  -0.9083669, -0.9090763, -0.9098501, -0.9103660, -0.9108818, -0.9114622, -0.9119781, -0.9125584, -0.9130743, -0.9135902,
  -0.9141706, -0.9146864, -0.9152023, -0.9157827, -0.9164920, -0.9175883, -0.9179107, -0.9181041, -0.9184911, -0.9189424,
  -0.9192649, -0.9195873, -0.9199742, -0.9204256, -0.9209415, -0.9214574, -0.9219088, -0.9225536, -0.9251975, -0.9290021,
  -0.9297114, -0.9293245, -0.9282928, -0.9263582, -0.9244882, -0.9232629, -0.9227471, -0.9228760, -0.9232629, -0.9233274,
  -0.9234564, -0.9239723, -0.9245526, -0.9250685, -0.9256489, -0.9261648, -0.9264872, -0.9266806, -0.9268741, -0.9270675,
  -0.9271320, -0.9271965, -0.9272610, -0.9272610, -0.9273255, -0.9273255, -0.9273255, -0.9274545, -0.9277769, -0.9280993,
  -0.9284862, -0.9288086, -0.9293245, -0.9298404, -0.9301628, -0.9302273, -0.9302918, -0.9303563, -0.9304852, -0.9306142,
  -0.9307432, -0.9308077, -0.9308722, -0.9310011, -0.9310011, -0.9310656, -0.9311301, -0.9311946, -0.9312591, -0.9313236,
  -0.9314525, -0.9316460, -0.9318394, -0.9320329, -0.9322263, -0.9324198, -0.9325488, -0.9328067, -0.9330002, -0.9331936,
  -0.9333226, -0.9335160, -0.9337095, -0.9340319, -0.9343543, -0.9346768, -0.9349992, -0.9352571, -0.9355151, -0.9357085,
  -0.9360954, -0.9364823, -0.9369982, -0.9374496, -0.9371272, -0.9369982, -0.9369982, -0.9369982, -0.9370627, -0.9372562,
  -0.9373851, -0.9375141, -0.9376431, -0.9377076, -0.9377720, -0.9377720, -0.9376431, -0.9375141, -0.9374496, -0.9375141,
  -0.9376431, -0.9377720, -0.9379655, -0.9381590, -0.9383524, -0.9384169, -0.9383524, -0.9382234, -0.9380945, -0.9379655,
  -0.9377076, -0.9375786, -0.9373207, -0.9371917, -0.9373207, -0.9374496, -0.9376431, -0.9377720, -0.9378365, -0.9379655,
  -0.9380945, -0.9382234, -0.9383524, -0.9384814, -0.9386103, -0.9387393, -0.9391262, -0.9396421, -0.9402225, -0.9406739,
  -0.9410608, -0.9414477, -0.9418346, -0.9421570, -0.9424150, -0.9426729, -0.9429308, -0.9431888, -0.9434467, -0.9437047,
  -0.9440271, -0.9442850, -0.9444140, -0.9446074, -0.9448009, -0.9449944, -0.9451233, -0.9453168, -0.9455102, -0.9455747,
  -0.9455747, -0.9458327, -0.9461551, -0.9465420, -0.9469934, -0.9473803, -0.9477672, -0.9481541, -0.9495083, -0.9526036,
  -0.9558278, -0.9594390, -0.9628567, -0.9664034, -0.9696276, -0.9713042, -0.9713687, -0.9701435, -0.9689183, -0.9669192,
  -0.9624053, -0.9587941, -0.9555699, -0.9543447, -0.9538933, -0.9546671, -0.9566016, -0.9595680, -0.9592455, -0.9551830,
  -0.9544092, -0.9539578, -0.9534419, -0.9529905, -0.9529260, -0.9528615, -0.9527325, -0.9526681, -0.9525391, -0.9524746,
  -0.9523456, -0.9522167, -0.9520877, -0.9517008, -0.9513139, -0.9508625, -0.9504111, -0.9500242, -0.9497018, -0.9495083,
  -0.9494438, -0.9493793, -0.9493148, -0.9491859, -0.9491859, -0.9491859, -0.9490569, -0.9485410, -0.9479607, -0.9473803,
  -0.9467355, -0.9458327, -0.9448654, -0.9438981, -0.9430598, -0.9422215, -0.9408028, -0.9402870, -0.9409318, -0.9415767,
  -0.9423505, -0.9433177, -0.9443495, -0.9455102, -0.9467999, -0.9481541, -0.9495083, -0.9507335, -0.9517653, -0.9529260,
  -0.9540867, -0.9554409, -0.9569241, -0.9585362, -0.9602128, -0.9618894, -0.9636305, -0.9655650, -0.9676286, -0.9694986,
  -0.9713687, -0.9732388, -0.9751088, -0.9767854, -0.9784620, -0.9802031, -0.9820732, -0.9840077, -0.9852974, -0.9864582,
  -0.9874899, -0.9883927, -0.9892955, -0.9900048, -0.9907142, -0.9914880, -0.9924553, -0.9932291, -0.9939384, -0.9948412,
};
uint16_t wavetable0_len = sizeof(wavetable0) / sizeof(wavetable0[0]);

// Mt. Gassan.
float wavetable1[] = {
  -0.99980, -0.99406, -0.98956, -0.98628, -0.98198, -0.97441, -0.96458, -0.95577, -0.94574, -0.93714,
  -0.92690, -0.91871, -0.91011, -0.90254, -0.90070, -0.89803, -0.89476, -0.89169, -0.88739, -0.88329,
  -0.87654, -0.86876, -0.86118, -0.84623, -0.83456, -0.82391, -0.81532, -0.80815, -0.80139, -0.79545,
  -0.78972, -0.78153, -0.77416, -0.76966, -0.76618, -0.76269, -0.75696, -0.74959, -0.74263, -0.72871,
  -0.71233, -0.70086, -0.69533, -0.69206, -0.69185, -0.69247, -0.69001, -0.68653, -0.68305, -0.67998,
  -0.67916, -0.67834, -0.67772, -0.67752, -0.67690, -0.67158, -0.66462, -0.65950, -0.65418, -0.64353,
  -0.63247, -0.62203, -0.61343, -0.60811, -0.60135, -0.59419, -0.57760, -0.56675, -0.56839, -0.56941,
  -0.56429, -0.55856, -0.55446, -0.54791, -0.54259, -0.53747, -0.53010, -0.52129, -0.51208, -0.49611,
  -0.48853, -0.48178, -0.47441, -0.47011, -0.46376, -0.45516, -0.44799, -0.44124, -0.43387, -0.42875,
  -0.42527, -0.42424, -0.42404, -0.42424, -0.42445, -0.42179, -0.42097, -0.41216, -0.40090, -0.39988,
  -0.39824, -0.39783, -0.40356, -0.40213, -0.40213, -0.40192, -0.40090, -0.40192, -0.40602, -0.41257,
  -0.41953, -0.42322, -0.42240, -0.41933, -0.41851, -0.41278, -0.40827, -0.40111, -0.39558, -0.39414,
  -0.39414, -0.39148, -0.38432, -0.37469, -0.36466, -0.35156, -0.33661, -0.32146, -0.30958, -0.29259,
  -0.27457, -0.25717, -0.24652, -0.23812, -0.22973, -0.22215, -0.21540, -0.20741, -0.19656, -0.18714,
  -0.16523, -0.14087, -0.12346, -0.12224, -0.12101, -0.11978, -0.11855, -0.11712, -0.11568, -0.11425,
  -0.11282, -0.11138, -0.11179, -0.11302, -0.11405, -0.11527, -0.11650, -0.11753, -0.11937, -0.12121,
  -0.12285, -0.12428, -0.12510, -0.12572, -0.12633, -0.12735, -0.12735, -0.12735, -0.12674, -0.12572,
  -0.12449, -0.12346, -0.12224, -0.12080, -0.11937, -0.11650, -0.11364, -0.11118, -0.10852, -0.10565,
  -0.10340, -0.10258, -0.10115, -0.10012, -0.10074, -0.10135, -0.10197, -0.10278, -0.10483, -0.10831,
  -0.11138, -0.11486, -0.11835, -0.12162, -0.12326, -0.12510, -0.12735, -0.13206, -0.13595, -0.13780,
  -0.13698, -0.13165, -0.12285, -0.11876, -0.11446, -0.11384, -0.11384, -0.11527, -0.11773, -0.12101,
  -0.12408, -0.12613, -0.12265, -0.11548, -0.10831, -0.10238, -0.09910, -0.09603, -0.09275, -0.08968,
  -0.08661, -0.08333, -0.07821, -0.07351, -0.06839, -0.06327, -0.05569, -0.04771, -0.04095, -0.03296,
  -0.02723, -0.02211, -0.01802, -0.01290, -0.00799, -0.00512, -0.00143, 0.00348, 0.00635, 0.00225,
  -0.00164, -0.00164, -0.00164, -0.00164, -0.00164, -0.00143, -0.00020, 0.00102, 0.00225, 0.00164,
  0.00184, 0.00205, 0.00328, 0.00614, 0.01085, 0.01454, 0.01802, 0.02273, 0.02867, 0.03645,
  0.04320, 0.04914, 0.05508, 0.06102, 0.06736, 0.07391, 0.08047, 0.08722, 0.09419, 0.10115,
  0.10565, 0.10975, 0.11364, 0.11753, 0.12101, 0.12776, 0.13554, 0.13903, 0.14414, 0.15233,
  0.16114, 0.16994, 0.17834, 0.18796, 0.19902, 0.21233, 0.22625, 0.23690, 0.24713, 0.25717,
  0.26720, 0.27539, 0.28276, 0.29075, 0.29894, 0.30733, 0.31777, 0.32965, 0.33968, 0.34787,
  0.35463, 0.36466, 0.37367, 0.38186, 0.39005, 0.39947, 0.40991, 0.41994, 0.42916, 0.43366,
  0.43939, 0.44533, 0.45127, 0.45700, 0.46212, 0.46744, 0.47502, 0.48526, 0.49570, 0.50635,
  0.51454, 0.51781, 0.52109, 0.52437, 0.52396, 0.52170, 0.52048, 0.51904, 0.51699, 0.51536,
  0.51597, 0.51658, 0.51720, 0.51761, 0.51884, 0.52211, 0.52539, 0.52867, 0.53215, 0.53686,
  0.54136, 0.54586, 0.55037, 0.55590, 0.56204, 0.56859, 0.57473, 0.58006, 0.58518, 0.59029,
  0.59623, 0.60319, 0.61036, 0.62142, 0.63411, 0.64107, 0.64701, 0.64844, 0.64517, 0.63186,
  0.62039, 0.60688, 0.58804, 0.57596, 0.56306, 0.55098, 0.53788, 0.52641, 0.51515, 0.50246,
  0.48956, 0.47461, 0.46253, 0.45352, 0.44226, 0.42793, 0.41605, 0.40377, 0.39230, 0.38432,
  0.37572, 0.37039, 0.36916, 0.36671, 0.36323, 0.36220, 0.36241, 0.36241, 0.36978, 0.38206,
  0.39496, 0.40152, 0.41011, 0.41667, 0.42117, 0.43632, 0.45803, 0.47768, 0.49447, 0.51249,
  0.52539, 0.53931, 0.55426, 0.56716, 0.58047, 0.59644, 0.61057, 0.62408, 0.63862, 0.65479,
  0.66503, 0.67158, 0.67281, 0.66790, 0.65786, 0.64455, 0.63063, 0.61630, 0.60238, 0.58784,
  0.57412, 0.57678, 0.58415, 0.58415, 0.58088, 0.57351, 0.56347, 0.55753, 0.54975, 0.53911,
  0.53296, 0.54075, 0.55221, 0.56102, 0.56757, 0.59603, 0.61794, 0.62469, 0.62715, 0.63391,
  0.63391, 0.62551, 0.62674, 0.63370, 0.63636, 0.65131, 0.67711, 0.69226, 0.70045, 0.70700,
  0.71274, 0.72195, 0.72789, 0.73444, 0.74427, 0.75880, 0.77314, 0.78911, 0.80508, 0.82146,
  0.83784, 0.85053, 0.86527, 0.87920, 0.89210, 0.90336, 0.91380, 0.92281, 0.92998, 0.93817,
  0.94717, 0.95905, 0.96949, 0.97973, 0.98956, 0.99939, 0.99775, 1.00000, 1.00000, 0.99386,
  0.99099, 0.98792, 0.98731, 0.98710, 0.98608, 0.98485, 0.98075, 0.97809, 0.97482, 0.97133,
  0.97133, 0.97133, 0.97174, 0.97297, 0.97441, 0.97563, 0.97727, 0.97830, 0.97830, 0.97727,
  0.97604, 0.97604, 0.97666, 0.97727, 0.97789, 0.97871, 0.97932, 0.97912, 0.97830, 0.97748,
  0.97645, 0.97543, 0.97420, 0.97256, 0.97052, 0.96847, 0.96601, 0.96355, 0.96048, 0.95639,
  0.95209, 0.94697, 0.94185, 0.93448, 0.92649, 0.91892, 0.90909, 0.89988, 0.89333, 0.88677,
  0.88022, 0.87551, 0.87101, 0.86650, 0.86200, 0.85811, 0.85483, 0.85176, 0.84869, 0.84603,
  0.84296, 0.83989, 0.83640, 0.83251, 0.82842, 0.82412, 0.82002, 0.81572, 0.81122, 0.80651,
  0.80180, 0.79709, 0.79177, 0.78665, 0.78174, 0.77641, 0.77150, 0.76618, 0.76249, 0.75901,
  0.75532, 0.75020, 0.74529, 0.74038, 0.73649, 0.73239, 0.72830, 0.72379, 0.72031, 0.71663,
  0.71335, 0.71028, 0.70721, 0.70434, 0.70147, 0.69820, 0.69492, 0.68980, 0.68530, 0.68161,
  0.67834, 0.67649, 0.67342, 0.66749, 0.66175, 0.65581, 0.64844, 0.64025, 0.63206, 0.62428,
  0.61794, 0.60770, 0.59193, 0.58129, 0.57166, 0.56470, 0.55692, 0.54730, 0.53481, 0.52621,
  0.51904, 0.51188, 0.50287, 0.49406, 0.48587, 0.47850, 0.47133, 0.46294, 0.45495, 0.44758,
  0.43939, 0.43120, 0.42035, 0.41073, 0.40418, 0.39824, 0.39271, 0.38677, 0.38247, 0.37858,
  0.37633, 0.37346, 0.37101, 0.36957, 0.36814, 0.36671, 0.36466, 0.36814, 0.36998, 0.37162,
  0.36855, 0.36323, 0.35708, 0.35217, 0.34705, 0.33968, 0.33333, 0.32719, 0.31757, 0.30651,
  0.30057, 0.29423, 0.28849, 0.27989, 0.27191, 0.26290, 0.25143, 0.24120, 0.23280, 0.22441,
  0.21274, 0.20270, 0.19554, 0.19083, 0.18612, 0.17916, 0.17158, 0.16523, 0.16052, 0.15377,
  0.14824, 0.14107, 0.13329, 0.12510, 0.11794, 0.11097, 0.10381, 0.09623, 0.08763, 0.07883,
  0.06941, 0.06102, 0.05426, 0.04791, 0.04238, 0.03296, 0.01966, 0.00839, -0.00205, -0.01188,
  -0.02068, -0.02846, -0.03153, -0.03665, -0.04423, -0.05549, -0.06613, -0.07535, -0.08456, -0.09337,
  -0.10094, -0.10913, -0.11835, -0.12551, -0.13309, -0.14005, -0.14742, -0.15889, -0.16790, -0.17363,
  -0.17854, -0.18387, -0.19042, -0.19615, -0.20209, -0.21396, -0.22502, -0.24263, -0.25921, -0.27273,
  -0.28256, -0.29054, -0.30119, -0.31122, -0.32473, -0.33927, -0.35197, -0.35975, -0.36405, -0.36773,
  -0.36896, -0.37060, -0.37305, -0.37817, -0.38370, -0.39005, -0.39476, -0.39967, -0.40152, -0.40172,
  -0.39988, -0.39926, -0.39906, -0.40049, -0.40029, -0.40254, -0.40356, -0.40500, -0.40500, -0.40909,
  -0.41339, -0.42035, -0.42649, -0.43489, -0.44697, -0.45864, -0.46888, -0.47789, -0.48649, -0.49447,
  -0.50225, -0.51229, -0.52048, -0.52723, -0.53501, -0.54791, -0.56061, -0.57125, -0.57740, -0.58129,
  -0.58477, -0.58866, -0.59193, -0.59623, -0.60811, -0.61876, -0.62674, -0.63411, -0.64660, -0.65889,
  -0.66769, -0.67670, -0.68591, -0.69492, -0.70495, -0.71663, -0.72482, -0.73362, -0.74775, -0.76495,
  -0.77989, -0.79361, -0.81122, -0.83374, -0.85852, -0.88268, -0.89599, -0.90991, -0.92834, -0.94881,
  -0.95291, -0.95332, -0.95025, -0.94492, -0.94369, -0.93694, -0.92547, -0.91585, -0.90971, -0.90377,
  -0.89517, -0.88514, -0.87551, -0.86568, -0.85790, -0.85217, -0.84459, -0.83456, -0.82187, -0.81183,
  -0.82760, -0.84971, -0.86773, -0.88534, -0.90049, -0.91216, -0.90356, -0.88452, -0.86077, -0.84234,
  -0.82473, -0.80999, -0.79771, -0.78645, -0.78665, -0.79259, -0.80119, -0.81020, -0.81962, -0.83477,
  -0.84767, -0.85995, -0.86876, -0.87592, -0.88514, -0.89558, -0.89906, -0.90008, -0.90111, -0.90377,
  -0.90971, -0.91339, -0.91708, -0.92158, -0.92383, -0.92895, -0.93550, -0.94615, -0.95639, -0.96785,
  -0.98137, -0.99345,
};
uint16_t wavetable1_len = sizeof(wavetable1) / sizeof(wavetable1[0]);

